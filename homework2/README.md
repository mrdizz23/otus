<img width="907" height="722" alt="image" src="https://github.com/user-attachments/assets/08fc9bba-cec3-4359-bea4-0b3f2119e76a" />

# Анализ возможных запросов\отчетов\поиска данных.

## Возможные запросы по поиску данных
- В таблице **`patinets`** поиск по составному полю `nane` + `surname`, а также по номеру телефона `phone`
- В таблице **`doctors`** аналогичный поиск по составному полю `nane` + `surname` с усливием `is_active`, а также поиск по полю `speciality`
- В таблицах **`bookings`** и **`medical_history`** поиск по полям `clinic_id`, `patinent_id` и `doctor_id`
- В таблице **`calls`** поиск по полям `phone` и `booking_id`


## Возможные запросы по отчетности
Основные таблицы для построения запросов по отчетности и поиску данных - **`bookings`** и **`medical_history`**.
- В таблице **`medical_history`** необходимы количественные показатели по каждому пациенту, доктору за определенный временной интервал
- В таблице **`bookings`** статистика бронирования по статусам `is_planned`, `is_approved` и `is_finished`
- А также нелишним будет статистика обращений из таблицы **`calls`** в разрезе номера телефона `phone` и/или `booking_id`

# Анализ кардинальности.
Кардинальность приведенных выше полей по поиску и отчетности считаем высокой, поскольку в них низкое количество повторяемых значений

# Дополнительные индексы.
```CREATE INDEX idx_patients_full_name ON patients (surname, name);```  
Составной индекс по Фамилии и имени пацинта (именно в таком порядке с уменьшением кардинальности) для быстрого поиска  

```CREATE INDEX idx_patients_phone ON patients (phone);```  
Индекс для быстрого поиска пациента по номеру телефона

```CREATE INDEX idx_doctors_full_name ON doctors (surname, name) where (is_active);```  
Составной индекс для быстрого поиска активного (находящегося не в отпуске, и не уволенного) доктора

```CREATE INDEX idx_calls_phone ON calls (phone);```
Индекс для получения отчета истории звонков по номеру телефона

# Ограничения по полям.
## Уникальность
- Ни одно поле не будет уникальным, даже номер телефона или email, принимая возможность записи паиентов (в том числе детей) родсвенниками. Единственный возможный признак уникальности пацеиента - составной Primary Key, включающий в себя поля `surname`, `name`, `birthdate` и `phone`

## Условия для значений
Основное условие для всех полей кроме отчества - NOT NULL. Остальные ограничения будут реализованы на стороне бизнесс-логики, чтобы не получить неожиданного поведения при полуении ошибки на стороне приложения во время работы с БД. Но если этой условностью принебречь, то чисто гипотетически можно наложить следующие условия:
- поле `phone` во всех таблицах должно содержить определенное количество символов в пормате номера телефона
- поле `email` должно быть в определенном формате user@subdomain.domain
